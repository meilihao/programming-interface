# hardware

## cpu
### 指令集
参考:
- [《手把手教你设计CPU——RISC-V处理器篇》]

CPU的灵魂是指令集架构（Instruction Set Architecture，ISA）.

指令集，顾名思义是一组指令的集合，而指令是指处理器进行操作的最小单元（譬如加减乘除操作或者读/写存储器数据）.

![指令集架构示意图](/misc/img/arch/isa.png)

指令集架构主要分为复杂指令集（Complex Instruction Set Computer，CISC）和精简指令集（Reduced Instruction Set Computer，RISC），两者的主要区别如下:
- CISC不仅包含了处理器常用的指令，还包含了许多不常用的特殊指令. 其指令数目比较多，所以称为复杂指令集.
- RISC只包含处理器常用的指令，而对于不常用的操作，则通过执行多条常用指令的方式来达到同样的效果, 由于其指令数目比较精简，所以称为精简指令集.

指令集使用也遵循8/2原则: CISC指令集定义的指令，只有20%被经常使用到，而有80%则很少被用到, 那些很少被用到的特殊指令尤其让CPU设计变得极为复杂，大大增加了硬件设计的时间成本与面积开销. 因此自从RISC诞生之后，**基本上所有现代指令集架构都选择使用RISC架构**.

通俗来讲，处理器架构的位数是指通用寄存器的宽度，其决定了寻址范围的大小、数据运算能力的强弱. 除嵌入式主流进入32bit时代外, 目前主流的mobile、pc和server，均使用64位架构.

> 处理器指令集架构的宽度和指令的编码长度无任何关系. 并不是说64位架构的指令长度为64位（这是一个常见的误区）. **从理论上来讲，指令本身的编码长度越短越好，因为可以节省代码的存储空间**. 因此即便在64位的架构中，也大量存在16位编码的指令，且基本上很少出现过64位长的指令编码.

主流指令集架构:
- x86

    pc和server中的主流, 是CISC. Intel公司通过内部`微码化`的方法克服掉了CISC架构的部分缺点.

    微码化: 是指将复杂的CISC指令先用硬件解码器翻译成对应的内部简单指令（微码）序列，然后送给处理器流水线执行的方法，使得x86的处理器核也变成了一种RISC的形式，从而能够借鉴RISC架构的优点. 不过，额外的硬件解码器同样也会带来额外的复杂度与面积开销.
- arm

    嵌入式和mobile的主流.

    arm cpu分类:
    - Cortex-A：面向性能密集型系统的应用处理器核
    - Cortex-R：面向实时应用的高性能核
    - Cortex-M：面向各类嵌入式应用的微控制器核

    Cortex-A、Cortex-M和Cortex-R架构的最大区别是前者包含了**存储器管理单元（Memory Management Unit，MMU），因此可以支持操作系统的运行**.